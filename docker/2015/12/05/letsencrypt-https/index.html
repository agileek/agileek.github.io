<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Http is dead</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Another blog on agile and java. Maybe i'll add kittens and food recipe if my partner helps me.">
    <link rel="icon" type="image/png" href="/images/home.png" />
    <link rel="canonical" href="https://agileek.github.io/docker/2015/12/05/letsencrypt-https/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/main.css ">
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-45194812-2', 'auto');
        ga('send', 'pageview');
    </script>

    <script>
      var host = "agileek.github.io";
      if ((host == window.location.host) && (window.location.protocol != "https:"))
          window.location.protocol = "https";
    </script>
</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/"><img alt="home" src="/images/home.png" />Agile & Java</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          
            
            
          
        
          
            
            
          
        
          
            
            
          
        
          
            
            
          
        
          
            
            
          
        
          
            
            
          
        
          
            
            
          
        
          
        
          
        
          
        
          
        
          
            
            <a class="page-link" href="/food/">Food</a>
            
          
        
          
        
          
            
            <a class="page-link" href="/about/">About</a>
            
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">

    <meta property="twitter:card" content="summary" />
    <meta property="twitter:site" content="@BitardMichael" />
    <meta property="twitter:title" content="Http is dead" />
    <meta property="twitter:description" content="In a previous article I talked about switching to https. Since the 3rd December, Let’s Encrypt is in public beta1, that means that everybody can have free trusted ssl certificates. That’s right, you heard it. What would be an agileek..." />
    <meta property="twitter:image" content="/images/posts/letsencrypt/meme.jpg" />

    <meta itemprop="keywords" content="letsencrypt,docker" />
    <meta itemprop="description" content="In a previous article I talked about switching to https. Since the 3rd December, Let’s Encrypt is in public beta1, that means that everybody can have free trusted ssl certificates. That’s right, you heard it. What would be an agileek..." />

    <header class="post-header">
        <h1 itemprop="name">Http is dead</h1>
        <time class="meta" itemprop="datePublished" datetime="2015-12-05">Dec 5, 2015</time>
        
    </header>

    <div class="post-content" itemprop="articleBody">
        <p>In a <a href="/jekyll/2015/11/20/disqus-https-and-http/">previous article</a> I talked about switching to <strong><em>https</em></strong>.</p>

<p>Since the 3rd December, <a href="https://letsencrypt.org/"><em>Let’s Encrypt</em></a> is in public beta<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>, that means that everybody can have free trusted ssl certificates.</p>

<p>That’s right, you heard it.</p>

<p><img src="/images/posts/letsencrypt/meme.jpg" alt="OprahHttps" /></p>

<p>What would be an agileek article without a little bit of <strong>Docker</strong> in it?</p>

<h1 id="goal"> Goal</h1>

<p>I will show you how to generate and use an ssl certificate with nginx.</p>

<p>First, you generate the certificate with:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">docker run -it --rm -p 443:443 --name letsencrypt -v /etc/letsencrypt:/etc/letsencrypt -v /var/lib/letsencrypt:/var/lib/letsencrypt quay.io/letsencrypt/letsencrypt:latest --server https://acme-v01.api.letsencrypt.org/directory certonly -a standalone -d hello.lilymic.gotgeeks.com</code></pre></div>

<p>Then you configure your nginx in order to use this certificates :</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ssl_certificate      /etc/letsencrypt/live/lilymic.gotgeeks.com-0001/fullchain.pem<span class="p">;</span>
ssl_certificate_key  /etc/letsencrypt/live/lilymic.gotgeeks.com-0001/privkey.pem<span class="p">;</span>
ssl_session_timeout 1d<span class="p">;</span>
ssl_session_cache shared:SSL:50m<span class="p">;</span>
ssl_session_tickets off<span class="p">;</span>


<span class="c"># modern configuration. tweak to your needs.</span>
ssl_protocols TLSv1.1 TLSv1.2<span class="p">;</span>
ssl_ciphers <span class="s1">&#39;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK&#39;</span><span class="p">;</span>
<span class="c">#    ssl_prefer_server_ciphers on;</span>

<span class="c"># HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)</span>
add_header Strict-Transport-Security max-age<span class="o">=</span>15768000<span class="p">;</span>

<span class="c"># OCSP Stapling ---</span>
<span class="c"># fetch OCSP records from URL in ssl_certificate and cache them</span>
ssl_stapling on<span class="p">;</span>
ssl_stapling_verify on<span class="p">;</span>

    <span class="c">## verify chain of trust of OCSP response using Root CA and Intermediate certs</span>

server <span class="o">{</span>
        listen       <span class="m">443</span> ssl<span class="p">;</span>
        server_name  hello.lilymic.gotgeeks.com<span class="p">;</span>

        location / <span class="o">{</span>            
            add_header Content-Type text/plain<span class="p">;</span>
            <span class="k">return</span> <span class="m">200</span> <span class="s1">&#39;Take a look at this awesome certificate!&#39;</span><span class="p">;</span>
        <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Aaaaaaand it’s done.</p>

<p>You can look at <a href="https://hello.lilymic.gotgeeks.com/">https://hello.lilymic.gotgeeks.com/</a> and see that everything is <img src="/images/posts/letsencrypt/super_green.gif" alt="so green" /></p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>You can donate to them:  <a href="https://letsencrypt.org/donate">https://letsencrypt.org/donate</a> or to EFF: <a href="https://eff.org/donate-le">https://eff.org/donate-le</a> <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>

    <div id="social_sharing">
        <a href="https://twitter.com/share" class="twitter-share-button" data-text="Http is dead, long live https!" data-hashtags="letsencrypt,docker">Tweet</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'agileek';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the
        <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by
        <span class="logo-disqus">Disqus</span>
    </a>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Agile & Java</h2>

    <div class="footer-col-1 column">
      <ul>
        <li>Geek & other stuff</li>
        <li><a href="mailto:bitard.michael@gmail.com">bitard.michael@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/MichaelBitard">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">MichaelBitard</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/BitardMichael">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">BitardMichael</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Another blog on agile and java. Maybe i'll add kittens and food recipe if my partner helps me.</p>
    </div>

  </div>

</footer>


    </body>
</html>